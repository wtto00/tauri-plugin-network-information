# Tauri Plugin network-information

**Warning ⚠️: This plugin is still in development and is currently unavailable.**

A plugin for [tauri@v2](https://v2.tauri.app/zh-cn/) to get network information on iOS and Android.

On the iOS platform, the first time the app is opened, it will ask the user whether to allow network connection. Developers need to know whether the user clicked allow or deny. This plugin can solve this problem.

## Platform Supported

| Platform | Supported |
| -------- | :-------: |
| Linux    |    ❌     |
| Windows  |    ❌     |
| macOS    |    ❌     |
| Android  |    ✅     |
| iOS      |    ✅     |

## Setup

Install the `network-information` plugin to get started.

1. Run the following command in the `src-tauri` folder to add the plugin to the project’s dependencies in `Cargo.toml`:

   ```shell
   cargo add tauri-plugin-network-information@0.1 --target 'cfg(any(target_os = "android", target_os = "ios"))'
   ```

1. Modify `lib.rs` to initialize the plugin:

   ```diff
    #[cfg_attr(mobile, tauri::mobile_entry_point)]
    pub fn run() {
        tauri::Builder::default()
            .setup(|app| {
   +            #[cfg(mobile)]
   +            app.handle().plugin(tauri_plugin_network_informations::init())?;
                Ok(())
            })
            .run(tauri::generate_context!())
            .expect("error while running tauri application");
    }
   ```

1. Modify `src-tauri/capabilities/mobile.json` to Allow the frontend to execute some commands.

   ```diff
    {
      "$schema": "../gen/schemas/mobile-schema.json",
      "identifier": "mobile",
      "description": "Capability for the main window on mobile platform",
      "windows": ["main"],
      "permissions": [
   +    "network-information:default"
      ],
      "platforms": ["android", "iOS"]
    }
   ```

   [All permissions list](./permissions/autogenerated/reference.md).

1. Install the JavaScript Guest bindings using your preferred JavaScript package manager:

   ```shell
   pnpm add tauri-plugin-network-information-api@0.1
   ```

## Usage

### Import Apis

```js
import { connection, Connection, isOnline, onNetworkAvailable } from "tauri-plugin-network-information-events-api";
```

### connection

Get the type of the current network connection.

```js
connection()
  .then((connectionType) => {
    switch (connectionType) {
      case Connection.ETHERNET:
        console.log("Current network connection is ethernet");
        break;
      case Connection.WIFI:
        console.log("Current network connection is WI-FI");
        break;
      case Connection.CELL_2G:
        console.log("Current network connection is 2G cellular");
        break;
      case Connection.CELL_3G:
        console.log("Current network connection is 3G cellular");
        break;
      case Connection.CELL_4G:
        console.log("Current network connection is 4G cellular");
        break;
      case Connection.CELL_5G:
        console.log("Current network connection is 5G cellular");
        break;
      case Connection.CELL:
        console.log("Current network connection is cellular");
        break;
      case Connection.NONE:
        console.log("Current network connection is none");
        break;
      case Connection.UNKNOWN:
      default:
        console.log("Current network connection is unknown");
        break;
    }
  })
  .catch(console.error);
```

### isOnline

Check if the current connection can connect to the internet.

```js
isOnline({ hostname: "8.8.8.8", port: 53 })
  .then((online) => console.log(`Current connection ${online ? "can" : "can't"}  connect to the internet.`))
  .catch(console.error);
```

### onNetworkAvailable

Monitor whether the network is available.

Note that the network may be available, but it does not necessarily mean that it can connect to the internet; it may also connect to a network that cannot access the internet.

```js
onNetworkAvailable((available) => {
  console.log(`Current network connection is ${available ? "available" : "unavailable"}.`);
});
```
